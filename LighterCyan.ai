-- string starting//
-- string:LighterCyan:ai(1)
-- Parent Finder
local Ex = game:GetService("CoreGui").TopBarApp.TopBarApp.UnibarLeftFrame.HealthBar.ExperienceSettings

--[[
Error, Warn and Information Detectors
~~~~~~~~~~~~~~~~~~
Error: 0
Warn: 0
Information: 0
~~~~~~~~~~~~~~~~~~
Script state: Good
~~~~~~~~~~~~~~~~~~
]]

-- ====FUNCTION CORNER=====
local function Corner(Scale, Offset, Parent)
  local Corner = Instance.new("UICorner")
  Corner.CornerRadius = UDim.new(Scale or 0, Offset or 0)
  Corner.Parent = Parent
  return Corner
end
-- =====END FUNCTION CORNER====

-- =====FUNCTION UILISTLAYOUT=====
local HCenter = Enum.HorizontalAlignment.Center
local VCenter = Enum.VerticalAlignment.Center
local HLeft = Enum.HorizontalAlignment.Left
local VTop = Enum.VerticalAlignment.Top
local HRight = Enum.HorizontalAlignment.Right
local VBottom = Enum.VerticalAlignment.Bottom
local FillH = Enum.FillDirection.Horizontal
local FillV = Enum.FillDirection.Vertical
local SCustom = Enum.SortOrder.Custom
local SLayout = Enum.SortOrder.LayoutOrder
local SName = Enum.SortOrder.Name

local function createUIListLayout(parent, scale, offset, HZ, VT, SO, FILL)
    local list = Instance.new("UIListLayout")
    list.Padding = UDim.new(scale or 0, offset or 0)
    list.FillDirection = FILL or FillH
    list.HorizontalAlignment = HZ or HCenter
    list.VerticalAlignment = VT or VCenter
    list.SortOrder = SO or SName
    list.Parent = parent
    return list
end
-- =====END FUNCTION UILISTLAYOUT=====

-- ====FUNCTION UISTROKE=====
local ASMBorder = Enum.ApplyStrokeMode.Border
local ASMContextual = Enum.ApplyStrokeMode.Contextual

local LJMBevel = Enum.LineJoinMode.Bevel
local LJMMiter = Enum.LineJoinMode.Miter
local LJMRound = Enum.LineJoinMode.Round

local function Stroke(parent, ASM, R, G, B, LJM, Tn, Transy)
    local stroke = parent:FindFirstChildOfClass("UIStroke") or Instance.new("UIStroke")
    stroke.ApplyStrokeMode = ASM or ASMBorder
    stroke.Color = Color3.fromRGB(R or 255, G or 255, B or 255)
    stroke.LineJoinMode = LJM or LJMRound
    stroke.Thickness = Tn or 1
    stroke.Transparency = Transy or 0
    stroke.Parent = parent
    return stroke
end
-- =====END FUNCTION UISTROKE=====

-- ====FUNCTION UIGRADIENT=====
local function Gradient(parent, rotation, offsetX, offsetY, ...)
    local grad = parent:FindFirstChildOfClass("UIGradient") or Instance.new("UIGradient")
    grad.Rotation = rotation or 0
    grad.Offset = Vector2.new(offsetX or 0, offsetY or 0)

    local colors = {...}
    local keypoints = {}

    if #colors == 0 then
        keypoints = { ColorSequenceKeypoint.new(0, Color3.new(1,1,1)), ColorSequenceKeypoint.new(1, Color3.new(1,1,1)) }
    elseif #colors == 1 then
        keypoints = { ColorSequenceKeypoint.new(0, colors[1]), ColorSequenceKeypoint.new(1, colors[1]) }
    else
        for i, c in ipairs(colors) do
            local t = (i-1) / (#colors-1)
            table.insert(keypoints, ColorSequenceKeypoint.new(t, c))
        end
    end

    grad.Color = ColorSequence.new(keypoints)
    grad.Parent = parent
    return grad
end
-- =====END FUNCTION UIGRADIENT=====

-- ====FUNCTION UIPADDING (‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö Roblox)=====
local function Padding(parent, bottom, left, right, top)
    local pad = parent:FindFirstChildOfClass("UIPadding") or Instance.new("UIPadding")
    local function toUDim(value)
        if typeof(value) == "UDim" then
            return value
        elseif type(value) == "number" then
            return UDim.new(0, value)
        elseif type(value) == "table" and #value >= 2 then
            return UDim.new(value[1] or 0, value[2] or 0)
        else
            return UDim.new(0, 0)
        end
    end

    pad.PaddingBottom = toUDim(bottom)
    pad.PaddingLeft   = toUDim(left)
    pad.PaddingRight  = toUDim(right)
    pad.PaddingTop    = toUDim(top)

    pad.Parent = parent
    return pad
end
-- =====END FUNCTION UIPADDING=====

-- Instance
local Gui = Instance.new("ScreenGui")
Gui.Name = "LighterCyan.ai"
Gui.ResetOnSpawn = false
Gui.Parent = Ex -- Ex ‡∏Ñ‡∏∑‡∏≠ PlayerGui ‡πÉ‡∏ô‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏ô‡∏µ‡πâ
createUIListLayout(Gui, 0, 5, HCenter, VBottom, SName, FillV)

local useless = Instance.new("Frame")
useless.Name = "Holder"
useless.Size = UDim2.new(0.5, 0, 0.9, 0)
useless.BackgroundTransparency = 1 -- ‡πÅ‡∏Å‡πâ‡∏à‡∏≤‡∏Å .Transparency
useless.Active = false
useless.Parent = Gui
createUIListLayout(useless, 0, 5, HCenter, VCenter, SName, FillV)

local insetFrame = Instance.new("Frame")
insetFrame.Name = "InsetFrame"
insetFrame.Size = UDim2.new(0.96, 0, 1, 0)
insetFrame.BackgroundTransparency = 1
insetFrame.Parent = useless
createUIListLayout(insetFrame, 0, 5, HCenter, VBottom, SName, FillV)

-- [ INSETFRAME ]

local tabel = Instance.new("Frame")
tabel.Name = "a4_Tabel"
tabel.Size = UDim2.new(1, 0, 0, 70)
tabel.BackgroundTransparency = 1
tabel.Parent = insetFrame

local input = Instance.new("Frame")
input.Name = "a3_Input&Send"
input.Size = UDim2.new(1, 0, 0, 50)
input.BackgroundColor3 = Color3.fromRGB(255,255,255)
input.BackgroundTransparency = 0.6
input.Parent = insetFrame
Corner(0, 8, input)
Stroke(input, ASMBorder, 255, 255, 255, LJMRound, 1, 0)

local chat = Instance.new("Frame")
chat.Name = "a2_Chat"
chat.Size = UDim2.new(1, 0, 0, 300)
chat.BackgroundColor3 = Color3.fromRGB(255,255,255)
chat.BackgroundTransparency = 0.5
chat.Parent = insetFrame
Corner(0, 8, chat)
Stroke(chat,  ASMBorder, 255, 255, 255, LJMRound, 1, 0)
createUIListLayout(chat, 0, 5, HCenter, VCenter, SName, FillV)

local Scroll = Instance.new("ScrollingFrame")
Scroll.Name = "Chat"
Scroll.Size = UDim2.new(0.96, 0, 0.96, 0)
Scroll.BackgroundTransparency = 1
Scroll.ScrollBarThickness = 0
Scroll.ScrollingDirection = Enum.ScrollingDirection.Y
Scroll.CanvasSize = UDim2.new(0, 0, 0, 0)
Scroll.Visible = true
Scroll.Parent = chat
createUIListLayout(Scroll, 0, 5, HCenter, VTop, SLayout, FillV)

local Scroll2 = Instance.new("ScrollingFrame")
Scroll2.Name = "Settings"
Scroll2.Size = UDim2.new(0.96, 0, 0.96, 0)
Scroll2.BackgroundTransparency = 1
Scroll2.ScrollBarThickness = 0
Scroll2.ScrollingDirection = Enum.ScrollingDirection.Y
Scroll2.CanvasSize = UDim2.new(0, 0, 0, 0)
Scroll2.Visible = false
Scroll2.Parent = chat
createUIListLayout(Scroll2, 0, 5, HCenter, VTop, SLayout, FillV)

local Scroll3 = Instance.new("ScrollingFrame")
Scroll3.Name = "More"
Scroll3.Size = UDim2.new(0.96, 0, 0.96, 0)
Scroll3.BackgroundTransparency = 1
Scroll3.ScrollBarThickness = 0
Scroll3.ScrollingDirection = Enum.ScrollingDirection.Y
Scroll3.CanvasSize = UDim2.new(0, 0, 0, 0)
Scroll3.Visible = false
Scroll3.Parent = chat
createUIListLayout(Scroll3, 0, 5, HCenter, VTop, SLayout, FillV)


-- =====FUNCTION CHAT AI AND PLAYER=====
-- NOTE: functions use global Scroll variable so ensure Scroll is created before calling them

local function ai(Text, Offset)
    Offset = tonumber(Offset) or 0
    local ai = Instance.new("Frame")
    ai.Name = "ai"
    ai.BackgroundColor3 = Color3.fromRGB(255,255,255)
    ai.BackgroundTransparency = 0.8
    -- ‡πÉ‡∏™‡πà‡∏Ç‡∏ô‡∏≤‡∏î X scale + X offset ‡πÅ‡∏•‡∏∞ Y height (‡πÄ‡∏ä‡πà‡∏ô 72px)
    ai.Size = UDim2.new(0.96, 0, 0, Offset or 60)
    ai.Parent = Scroll -- ‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤ Scroll ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß (‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏Å)
    createUIListLayout(ai, 0, 10, HCenter, VCenter, SName, FillH)
    Stroke(ai, ASMBorder, 255, 255, 255, LJMRound, 1, 0) -- ‡πÉ‡∏ä‡πâ LJMRound (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà JSMRound)
    Corner(0, 8, ai)

    local image = Instance.new("ImageLabel")
    image.Name = "a1"
    image.Image = "rbxassetid://83032822916288" -- property ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ Image
    image.Size = UDim2.new(0, 50, 0, 50)
    image.BackgroundTransparency = 0.8
    image.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
    image.Parent = ai
    Corner(0, 8, image)
    Stroke(image, ASMBorder, 255, 255, 255, LJMRound, 1, 0)

    local text = Instance.new("TextLabel")
    text.Name = "a2"
    text.Text = tostring(Text or "")
    text.Size = UDim2.new(0.88, -8, 1, 0) -- ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ fill ‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á
    text.BackgroundTransparency = 1
    text.TextSize = 15
    text.TextWrapped = true
    text.TextXAlignment = Enum.TextXAlignment.Left
    text.TextYAlignment = Enum.TextYAlignment.Top
    text.Parent = ai
    return ai
end

local function plr(Text, Offset)
    Offset = tonumber(Offset) or 0
    local plrFrame = Instance.new("Frame")
    plrFrame.Name = "plr"
    plrFrame.BackgroundColor3 = Color3.fromRGB(255,255,255)
    plrFrame.BackgroundTransparency = 0.8
    plrFrame.Size = UDim2.new(0.96, 0, 0, Offset or 60) -- ‡∏£‡∏∞‡∏ö‡∏∏ height ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô
    plrFrame.Parent = Scroll
    createUIListLayout(plrFrame, 0, 10, HCenter, VCenter, SName, FillH)
    Stroke(plrFrame, ASMBorder, 255, 255, 255, LJMRound, 1, 0)
    Corner(0, 8, plrFrame)

    local image = Instance.new("ImageLabel")
    image.Name = "a2"
    image.Image = "rbxassetid://135474395711579"
    image.Size = UDim2.new(0, 50, 0, 50)
    image.BackgroundTransparency = 0.8
    image.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    image.Parent = plrFrame
    Corner(0, 8, image)
    Stroke(image, ASMBorder, 255, 255, 255, LJMRound, 1, 0)

    local text = Instance.new("TextLabel")
    text.Name = "a1"
    text.Text = tostring(Text or "")
    text.Size = UDim2.new(0.88, -8, 1, 0)
    text.BackgroundTransparency = 1
    text.TextSize = 15
    text.TextWrapped = true
    text.TextXAlignment = Enum.TextXAlignment.Right
    text.TextYAlignment = Enum.TextYAlignment.Top
    text.Parent = plrFrame
    return plrFrame
end

-- MESSAGE
local function mesg(Text, Offset, R, G, B, R1, G1, B1)
    Offset = tonumber(Offset) or 0
    local mesge = Instance.new("Frame")
    mesge.Name = "message"
    mesge.BackgroundColor3 = Color3.fromRGB(R, G, B or 255, 255, 255)
    mesge.BackgroundTransparency = 0.8
    mesge.Size = UDim2.new(0.96, 0, 0, Offset or 60) -- ‡∏£‡∏∞‡∏ö‡∏∏ height ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô
    mesge.Parent = Scroll
    createUIListLayout(mesge, 0, 10, HCenter, VCenter, SName, FillH)
    Stroke(mesge, ASMBorder, 255, 255, 255, LJMRound, 1, 0)
    Corner(0, 8, mesge)

    local text = Instance.new("TextLabel")
    text.Name = "a1"
    text.Text = tostring(Text or "")
    text.Size = UDim2.new(0.88, 0, 1, 0)
    text.BackgroundTransparency = 1
    text.TextColor3 = Color3.fromRGB(R1, G1, B1 or 0, 0, 0)
    text.TextSize = 15
    text.TextWrapped = true
    text.TextXAlignment = Enum.TextXAlignment.Center
    text.TextYAlignment = Enum.TextYAlignment.Center
    text.Parent = mesge
    return mesg
end

-- =====END FUNCTION AI AND PLAYER + END INSETFRAME=====

-- [ INPUT ]
local box = Instance.new("TextBox")
box.Name = "Ask"
box.Size = UDim2.new(0.72, 0, 0.9, 0)
box.Position = UDim2.new(0.02, 0, 0.05, 0)
box.BackgroundTransparency = 1
box.PlaceholderColor3 = Color3.fromRGB(95,95,95)
box.PlaceholderText = "Ask anything..."
box.Text = ""
box.TextScaled = true
box.TextColor3 = Color3.fromRGB(0,0,0)
box.RichText = true
box.ClearTextOnFocus = false
box.Parent = input

local send = Instance.new("TextButton")
send.Name = "Send"
send.Size = UDim2.new(0.076, 0, 0.9, 0)
send.Position = UDim2.new(0.75, 0, 0.05, 0)
send.BackgroundTransparency = 0.6
send.TextScaled = true
send.Text = "‚úì"
send.TextColor3 = Color3.fromRGB(0,0,0)
send.Parent = input
Corner(0, 8, send)
Stroke(send, ASMBorder, 255, 255, 255, LSMRound, 1, 0)

local clear = Instance.new("TextButton")
clear.Name = "clear"
clear.Size = UDim2.new(0.076, 0, 0.9, 0)
clear.Position = UDim2.new(0.835, 0, 0.05, 0)
clear.BackgroundTransparency = 0.6
clear.TextScaled = true
clear.Text = "√ó"
clear.TextColor3 = Color3.fromRGB(0,0,0)
clear.Parent = input
Corner(0, 8, clear)
Stroke(clear, ASMBorder, 255, 255, 255, LSMRound, 1, 0)

local rec = Instance.new("TextButton")
rec.Name = "re-chat"
rec.Size = UDim2.new(0.076, 0, 0.9, 0)
rec.Position = UDim2.new(0.918, 0, 0.05, 0)
rec.BackgroundTransparency = 0.6
rec.TextScaled = true
rec.Text = "re-chat"
rec.TextColor3 = Color3.fromRGB(0,0,0)
rec.Parent = input
Corner(0, 8, rec)
Stroke(rec, ASMBorder, 255, 255, 255, LSMRound, 1, 0)

mesg("Verison: Alpha Dev Test", 30, 76, 76, 76, 255, 255, 255)
mesg("copyright ¬© ExperienceSettings-ChatGPT 2025", 30, 76, 76, 76, 255, 255, 255)
ai("I'm ready to chat with you!", 60)
mesg(" --[ New Chat ]--", 30, 0, 0, 0, 255, 255, 255)
mesg("Chat is empty, Please type something!", 30, 0, 0, 0, 75, 75, 75)

local option = Instance.new("Frame")
option.Name = "a1_option"
option.Size = UDim2.new(1, 0, 0, 50)
option.BackgroundColor3 = Color3.fromRGB(255,255,255)
option.BackgroundTransparency = 1
option.Parent = insetFrame

local logo = Instance.new("Frame")
logo.Name = "a1.logo"
logo.Size = UDim2.new(0.2, 0, 0, 50)
logo.BackgroundColor3 = Color3.fromRGB(255,255,255)
logo.BackgroundTransparency = 0.6
logo.Parent = option
Corner(0, 8, logo)
Stroke(logo, ASMBorder, 255, 255, 255, LSMRound, 1, 0)

local lotext = Instance.new("TextLabel")
lotext.Name = "Text"
lotext.Size = UDim2.new(0.9, 0, 0.9, 0)
lotext.Position = UDim2.new(0.05, 0, 0.05, 0)
lotext.BackgroundTransparency = 1
lotext.Text = "LighterCyan"
lotext.TextColor3 = Color3.fromRGB(255, 255, 255)
lotext.TextStrokeTransparency = 0
lotext.TextStrokeColor3 = Color3.fromRGB(85, 255, 255)
lotext.TextScaled = true
lotext.Parent = logo

-- =====FUNCTION TEXTBUTTON=====
local function btm(Name, Text, Pos)
    local btm1 = Instance.new("Frame")
    btm1.Name = tostring(Name or "")
    btm1.BackgroundColor3 = Color3.fromRGB(255,255,255)
    btm1.BackgroundTransparency = 0.6
    btm1.Size = UDim2.new(0.1, 0, 0, 50)
    btm1.Position = UDim2.new(Pos or 0, 0, 0, 0)
    btm1.Parent = option
    Corner(0, 8, btm1)
    Stroke(btm1, ASMBorder, 255, 255, 255, LJMRound, 1, 0)

    local btm2 = Instance.new("TextButton")
    btm2.Size = UDim2.new(0.9, 0, 0.9, 0)
    btm2.Position = UDim2.new(0.05, 0, 0.05, 0)
    btm2.TextScaled = true
    btm2.BackgroundTransparency = 1
    btm2.Text = tostring(Text or "")
    btm2.Parent = btm1

    -- ‡πÉ‡∏™‡πà Gradient ‡∏î‡∏≥‡∏•‡πâ‡∏ß‡∏ô
    Gradient(btm2, 0, 0, 0, Color3.fromRGB(0,0,0), Color3.fromRGB(0,0,0))

    return btm1
end

btm("a2.Chat", "üó®Ô∏è Chat", 0)
btm("a3.Settings", "‚öôÔ∏è Settings", 0)
btm("a4.Explorer", "üåè Explorer", 0)
btm("a50.More", "üì¶ More", 0)
createUIListLayout(option, 0, 5, HLeft, VCenter, SName, FillH) -- btw Scaled 0 because UIListLayout haha, now go back to work.

-- === [SEND + TRAINING AI] snippet for LighterCyan.ai ===
-- ‡∏ß‡∏≤‡∏á snippet ‡∏ô‡∏µ‡πâ‡πÉ‡∏ô‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ó‡πå‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì (‡∏´‡∏•‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á GUI ‡πÅ‡∏•‡∏∞‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô plr/ai/mesg)

do
    -- ‡∏´‡∏≤ ScreenGui / element ‡∏ï‡∏≤‡∏°‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå LighterCyan.ai
    local function findGui()
        local s = script
        while s and not s:IsA("ScreenGui") and s.Parent do s = s.Parent end
        if s and s:IsA("ScreenGui") then return s end
        local plr = game:GetService("Players").LocalPlayer
        return plr and plr:FindFirstChild("PlayerGui") and plr.PlayerGui:FindFirstChild("LighterCyan.ai")
    end

    local Gui = findGui()
    if not Gui then
        warn("[SEND_SNIPPET] ‡πÑ‡∏°‡πà‡∏û‡∏ö ScreenGui LighterCyan.ai (snippet ‡∏à‡∏∞‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡πÉ‡∏ä‡πâ script.Parent ‡πÅ‡∏ó‡∏ô)")
        -- ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏° fallback ‡πÑ‡∏õ‡∏´‡∏≤‡πÉ‡∏ô script.Parent
        local p = script.Parent
        while p and not p:IsA("ScreenGui") and p.Parent do p = p.Parent end
        Gui = p
    end

    local input = Gui and Gui:FindFirstChild("a3_Input&Send")
    local chat  = Gui and Gui:FindFirstChild("a2_Chat")

    local box   = input and input:FindFirstChild("Ask")
    local send  = input and input:FindFirstChild("Send")
    local clear = input and input:FindFirstChild("clear")
    local rec   = input and input:FindFirstChild("re-chat")
    local Scroll = chat and chat:FindFirstChild("Chat")

    -- safety: ‡∏ñ‡πâ‡∏≤ element ‡∏´‡∏≤‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á error
    if not Scroll then
        warn("[SEND_SNIPPET] ‡πÑ‡∏°‡πà‡∏û‡∏ö Scroll (Chat). Snippet ‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÇ‡∏¢‡∏ô error ‡πÅ‡∏ï‡πà‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ö‡∏≤‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á")
    end

    -- TRAINING AI: corpus ‡πÅ‡∏•‡∏∞ helper (local; ‡πÑ‡∏°‡πà‡∏ä‡∏ô‡∏Å‡∏±‡∏ö‡∏™‡πà‡∏ß‡∏ô‡∏≠‡∏∑‡πà‡∏ô)
    local Corpus = {}

    local function AddToCorpus(s)
        if type(s) == "string" and s:match("%S") then
            table.insert(Corpus, s)
        end
    end

    local function TrainFromScroll()
        if not Scroll then return end
        for _, desc in ipairs(Scroll:GetDescendants()) do
            if desc:IsA("TextLabel") and (desc.Name == "a1" or desc.Name == "a2") then
                AddToCorpus(desc.Text)
            end
        end
    end

    local function ReadLatestA2()
        if not Scroll then return nil end
        local last = nil
        -- ‡∏ï‡∏£‡∏ß‡∏à children ‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏ó‡∏£‡∏Å (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö)
        for _, child in ipairs(Scroll:GetChildren()) do
            for _, d in ipairs(child:GetDescendants()) do
                if d:IsA("TextLabel") and d.Name == "a2" then
                    last = d.Text
                end
            end
        end
        return last
    end

    local function Think(input, context)
        input = tostring(input or "")
        context = tostring(context or "")
        local tokens = {}
        for w in input:gmatch("%w+") do tokens[#tokens+1] = w:lower() end
        for w in context:gmatch("%w+") do tokens[#tokens+1] = w:lower() end
        local bestScore, bestIdx = 0, nil
        for i, entry in ipairs(Corpus) do
            local score = 0
            local el = tostring(entry):lower()
            for _, t in ipairs(tokens) do
                if #t >= 3 and el:find(t, 1, true) then score = score + 1 end
            end
            if score > bestScore then bestScore, bestIdx = score, i end
        end
        if bestIdx then
            local reply = Corpus[bestIdx]
            if #reply > 200 then reply = string.sub(reply,1,200) .. "..." end
            return ("‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤ " .. reply)
        end
        if input ~= "" then return ("‡∏â‡∏±‡∏ô‡∏Ñ‡∏¥‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö: " .. string.sub(input,1,200)) end
        return ("‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ ‚Äî ‡∏•‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå‡∏≠‡∏∞‡πÑ‡∏£‡∏°‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢")
    end

    -- helper: update Canvas (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ UIListLayout ‡πÉ‡∏ô Scroll)
    local function safeUpdateCanvas()
        if not Scroll then return end
        local layout = Scroll:FindFirstChildOfClass("UIListLayout")
        if not layout then return end
        task.defer(function()
            local ok, size = pcall(function() return layout.AbsoluteContentSize end)
            if ok and size then
                pcall(function()
                    Scroll.CanvasSize = UDim2.new(0, 0, 0, math.max(size.Y + 8, Scroll.AbsoluteSize.Y))
                    Scroll.CanvasPosition = Vector2.new(0, math.max(0, size.Y - Scroll.AbsoluteSize.Y))
                end)
            end
        end)
    end

    -- ‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î Send: ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å plr(...), ‡∏•‡πâ‡∏≤‡∏á box, train, ‡∏≠‡πà‡∏≤‡∏ô a2 ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î, Think -> ai(...)
    if send and typeof(send.MouseButton1Click) == "RBXScriptSignal" then
        send.MouseButton1Click:Connect(function()
            pcall(function()
                if box and box:IsA("TextBox") then
                    local txt = tostring(box.Text or "")
                    if txt:match("%S") then
                        -- ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å plr ‡∏à‡∏≤‡∏Å‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ó‡πå‡∏´‡∏•‡∏±‡∏Å (‡πÑ‡∏ü‡∏•‡πå LighterCyan.ai ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏® plr‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß)
                        if type(plr) == "function" then
                            pcall(plr, txt, 60)
                        else
                            -- ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ plr ‡πÉ‡∏´‡πâ fallback ‡∏™‡∏£‡πâ‡∏≤‡∏á mesg ‡πÅ‡∏ö‡∏ö‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß (‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏î error)
                            pcall(function() mesg(txt, 60, 230,230,230, 0,0,0) end)
                        end

                        -- ‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° (clear)
                        pcall(function() box.Text = "" end)

                        -- training + think + reply
                        pcall(TrainFromScroll)
                        local latestA2 = ReadLatestA2() or ""
                        local reply = Think(txt, latestA2)
                        if type(ai) == "function" then
                            pcall(ai, reply, 60)
                        else
                            pcall(function() mesg(reply, 60, 230,230,230, 0,0,0) end)
                        end

                        -- update canvas (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
                        safeUpdateCanvas()
                    end
                end
            end)
        end)
    end

    -- Enter ‡∏™‡πà‡∏á‡∏î‡πâ‡∏ß‡∏¢
    if box and box:IsA("TextBox") then
        box.FocusLost:Connect(function(enter)
            if enter then
                pcall(function()
                    local txt = tostring(box.Text or "")
                    if txt:match("%S") then
                        if type(plr) == "function" then pcall(plr, txt, 60) else pcall(function() mesg(txt, 60, 230,230,230,0,0,0) end) end
                        pcall(function() box.Text = "" end)
                        pcall(TrainFromScroll)
                        local latestA2 = ReadLatestA2() or ""
                        local reply = Think(txt, latestA2)
                        if type(ai) == "function" then pcall(ai, reply, 60) else pcall(function() mesg(reply, 60, 230,230,230,0,0,0) end) end
                        safeUpdateCanvas()
                    end
                end)
            end
        end)
    end

    -- clear: ‡∏•‡πâ‡∏≤‡∏á box.Text
    if clear and typeof(clear.MouseButton1Click) == "RBXScriptSignal" then
        clear.MouseButton1Click:Connect(function()
            pcall(function()
                if box and box:IsA("TextBox") then box.Text = "" end
                safeUpdateCanvas()
            end)
        end)
    end

    -- re-chat: ‡∏•‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Frame children ‡πÉ‡∏ô Scroll (‡πÑ‡∏°‡πà‡πÅ‡∏ï‡∏∞ Scroll2/Scroll3)
    if rec and typeof(rec.MouseButton1Click) == "RBXScriptSignal" then
        rec.MouseButton1Click:Connect(function()
            pcall(function()
                if Scroll then
                    for _, child in ipairs(Scroll:GetChildren()) do
                        if child:IsA("Frame") then
                            pcall(function() child:Destroy() end)
                        end
                    end
                    safeUpdateCanvas()
                end
            end)
        end)
    end

    -- Expose API (‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏à‡∏≤‡∏Å‡∏™‡πà‡∏ß‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ó‡πå‡∏´‡∏•‡∏±‡∏Å)
    local API = {
        TrainFromScroll = TrainFromScroll,
        ReadLatestA2 = ReadLatestA2,
        Think = Think,
        GetCorpus = function() return Corpus end,
        updateCanvas = safeUpdateCanvas
    }
    -- ‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏≠‡∏∑‡πà‡∏ô (‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ï‡πà‡∏°‡∏µ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏´‡πâ)
    pcall(function()
        if Gui then
            local holder = Gui:FindFirstChild("__SEND_TRAIN_API__") or Instance.new("Folder")
            holder.Name = "__SEND_TRAIN_API__"
            holder.Parent = Gui
            for _, c in ipairs(holder:GetChildren()) do if c:IsA("BindableFunction") or c:IsA("BindableEvent") then pcall(function() c:Destroy() end) end end
            local bf = Instance.new("BindableFunction"); bf.Name = "GetAPI"; bf.Parent = holder
            bf.OnInvoke = function() return API end
        end
    end)
end
-- === end snippet ===
